name: Guide PR to Issue Submission

on:
  pull_request_target:
    types: [opened, reopened]
    branches:
      - main
    paths:
      - 'plugins.json'

permissions:
  issues: write
  pull-requests: write

jobs:
  comment:
    runs-on: ubuntu-latest
    steps:
      - name: Guide user to Issue submission
        uses: actions/github-script@v7
        with:
          script: |
            const prAuthor = context.payload.pull_request.user.login;

            const message = `## ğŸ“¢ æ¨èä½¿ç”¨ Issue æäº¤æ’ä»¶ / Please Use Issue Submission

            @${prAuthor} æ‚¨å¥½ï¼

            æˆ‘ä»¬å·²ç»æ¨å‡ºäº†æ›´ç®€å•çš„ **Issue æäº¤æ–¹å¼**ï¼Œæ— éœ€ Fork å’Œåˆ›å»º PRã€‚

            ### ğŸš€ æ¨èæµç¨‹

            1. å…³é—­æ­¤ PR
            2. ç‚¹å‡» [åˆ›å»º Issue](https://github.com/${context.repo.owner}/${context.repo.repo}/issues/new/choose)
            3. é€‰æ‹© **"Add Plugin / æ·»åŠ æ’ä»¶"** æ¨¡æ¿
            4. å¡«å†™æ’ä»¶ ID å’Œä»“åº“åœ°å€
            5. CI è‡ªåŠ¨éªŒè¯ï¼Œç»´æŠ¤è€…æ‰¹å‡†åè‡ªåŠ¨æ·»åŠ 

            ### âœ¨ Issue æ–¹å¼çš„ä¼˜åŠ¿

            | ç‰¹æ€§ | PR æ–¹å¼ | Issue æ–¹å¼ |
            |------|---------|------------|
            | éœ€è¦ Fork | âœ… éœ€è¦ | âŒ ä¸éœ€è¦ |
            | éœ€è¦æœ¬åœ° Git | âœ… éœ€è¦ | âŒ ä¸éœ€è¦ |
            | åˆå¹¶å†²çª | å¯èƒ½å‘ç”Ÿ | ä¸ä¼šå‘ç”Ÿ |
            | æ“ä½œå¤æ‚åº¦ | è¾ƒé«˜ | éå¸¸ç®€å• |

            ---

            > âš ï¸ **PR æäº¤æ–¹å¼å·²å¼ƒç”¨**ï¼Œåç»­å¯èƒ½ä¼šç§»é™¤æ”¯æŒã€‚
            >
            > å¦‚æœæ‚¨ä»å¸Œæœ›ä½¿ç”¨ PR æ–¹å¼ï¼Œæ­¤ PR ä»ä¼šè¿›è¡ŒéªŒè¯ï¼Œä½†å»ºè®®æ”¹ç”¨ Issueã€‚
            `;

            await github.rest.issues.createComment({
              owner: context.repo.owner,
              repo: context.repo.repo,
              issue_number: context.payload.pull_request.number,
              body: message
            });
